<!DOCTYPE html><html><head><meta name="robots" content="index,follow"/><meta name="description" content="I&#x27;m a software engineer based in Amsterdam, Netherlands. I&#x27;m passionate about building products that solve real-world problems."/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@ShalvaGegia"/><meta name="twitter:creator" content="@ShalvaGegia"/><meta property="og:title" content="MERN monorepo boilerplate | Shalva Gegia"/><meta property="og:description" content="I&#x27;m a software engineer based in Amsterdam, Netherlands. I&#x27;m passionate about building products that solve real-world problems."/><meta property="og:url" content="https://gegia.me/"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_IE"/><meta property="og:site_name" content="Shalva Gegia"/><title>MERN monorepo boilerplate | Shalva Gegia</title><meta charSet="UTF-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width,initial-scale=1"/><link rel="shortcut icon" href="/favicon.png"/><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/11e0f835b649af48.css" as="style"/><link rel="stylesheet" href="/_next/static/css/11e0f835b649af48.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-4dc2921e155e6a75.js" defer=""></script><script src="/_next/static/chunks/framework-00b57966872fc495.js" defer=""></script><script src="/_next/static/chunks/main-f4ae3437c92c1efc.js" defer=""></script><script src="/_next/static/chunks/pages/_app-bdd0f2a6f1512cc9.js" defer=""></script><script src="/_next/static/chunks/75fc9c18-289ba7b5fb63f228.js" defer=""></script><script src="/_next/static/chunks/451-b7d470dc21bf51a2.js" defer=""></script><script src="/_next/static/chunks/pages/article/%5Barticle%5D-88a1d5ebdd7e8e0e.js" defer=""></script><script src="/_next/static/lixbDq4aNc2m0zZOaRkxk/_buildManifest.js" defer=""></script><script src="/_next/static/lixbDq4aNc2m0zZOaRkxk/_ssgManifest.js" defer=""></script><script src="/_next/static/lixbDq4aNc2m0zZOaRkxk/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div><header class="w-full"><nav class="container mx-auto md:max-w-5xl flex items-center justify-between p-6"><a class="font-bold text-lg text-transparent bg-clip-text bg-gradient-to-br from-pink-400 to-indigo-600" href="/">Shalva Gegia</a><ul class="flex iAWriterQuattro"><li class="mr-3"><a class="text-ml inline-block transition-colors py-2 px-4 text-gray-500 no-underline hover:text-indigo-500 " href="/about">About</a></li><li class="mr-3"><a class="text-ml inline-block transition-colors py-2 px-4 text-gray-500 no-underline hover:text-indigo-500 " href="/notes">Notes</a></li><li class="mr-3"><a class="text-ml inline-block transition-colors py-2 px-4 text-gray-500 no-underline hover:text-indigo-500 " href="/garden">Garden ðŸŒ±</a></li></ul></nav></header><main class="container mx-auto max-w-5xl px-6"><article class="mt-8"><h2 class="text-3xl font-normal leading-normal mt-0 mb-0 text-gray-800">MERN monorepo boilerplate</h2><small class="text-gray-300">January 2018</small><article class="prose prose-img:inhe max-w-none pt-6 text-gray-500"><p>Hello reader,
I want to talk about monorepo, and also will share boilerplate for MERN (Mongo, Express.js, React, React-Native/Expo) stack.</p>
<p>When it comes to a real-life project, it consists of multiple services fronted, backend/API and mobile. We can split them into separate repositories, but sharing code between repositories is difficult when using multiple repositories. This is the moment where monorepo shines.</p>
<!-- read more -->
<p>Let's compare monorepo to mutli-repo style.</p>
<h4>Monorepo</h4>
<p>Monorepo is split into many single-repos. Each single-repo repository is read-only. You can change its code via pull-request to the monorepo.</p>
<h4>Multirepo</h4>
<p>The other approach is to manage multiple repositories. 1 package = 1 own repository. Each package has its own development, tagging, and even maintainers.</p>
<h4>Monolith</h4>
<p>Monolith IS NOT monorepo. Monolith is a huge amount of coupled code of one application that is hell to maintain.</p>
<p>This is what monorepo repository looks like</p>
<p align="center">
  <img src="https://cdn-images-1.medium.com/max/1600/1*95IEDUCN3mfU9vpTWXChhQ@2x.png" style="height:600px">
</p>
<h2>Boilerplate</h2>
<h5>Lerna</h5>
<blockquote>
<p>Lerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.</p>
</blockquote>
<p>Lerna tries to ease the management of npm links when dealing with multi-package projects hosted in a single repository. It analyzes the packages and automatically creates the required npm links between them. It also handles the execution of tasks across multiple packages and eases the pain of versioning and publishing.
It has its shortcomings but itâ€™s worth using it. Big projects like Babel and Jest use Lerna.</p>
<h5>Yarn workspaces</h5>
<blockquote>
<p>Workspaces are a new way to setup your package architecture (..) It allows you to setup multiple packages in such a way that you only need to run yarn install once to install all of them in a single pass.</p>
</blockquote>
<p>Your dependencies can be linked together, which means that your workspaces can depend on one another while always using the most up-to-date code available. This is also a better mechanism than yarn link since it only affects your workspace tree rather than your whole system.</p>
<h5>Eslint / Tslint / Stylelint / Prettier</h5>
<p>In this boilerplate eslint, tslint, stylelint and prettier are already isntalled, configured and ready to go!</p>
<h5>Husky / Lint-staged / Commit lint</h5>
<blockquote>
<p>Husky - Git hooks made easy</p>
</blockquote>
<p>Husky is a tool which gives us the ability to catch GIT hooks like commit and/or push</p>
<blockquote>
<p>Lint-staged - Run linters against staged git files and don't let ðŸ’© slip into your code base!</p>
</blockquote>
<p>Lint-staged is a nice tool to run linters (for example: eslint) on staged files to prevent commit code which is note linter compatible</p>
<blockquote>
<p>Conventional (Semantic) Commit Messages - is a lightweight convention on top of commit messages. It provides an easy set of rules for creating an explicit commit history;</p>
</blockquote>
<p>Conventional or Semantic commit messages is naming convension, that helps us to easily determine what commit contains and also it's very helpful to avoid multiple fixes in a single commit.</p>
<p>If you are not familiar with conventional commits, here are some links with detailed info</p>
<p><a href="https://www.conventionalcommits.org/en/v1.0.0-beta.4/">Conventional Commits</a>
<a href="https://seesparkbox.com/foundry/semantic_commit_messages">Semantic Commits</a></p>
<h3>How to start</h3>
<p>All you need is to clone <a href="https://github.com/shakogegia/mern-monorepo-boilerplate">repository</a>, run <code>yarn</code> to install dependencies and you can start the project by running <code>yarn dev</code></p>
<p><img src="https://thepracticaldev.s3.amazonaws.com/i/7y04oyepefran5du6nv1.png" alt="Alt Text"></p>
<p>Packages structure:</p>
<ul>
<li>client - React app created via<code>create-react-app</code></li>
<li>api - Node.js / Express.js</li>
<li>socket - Socket.io server</li>
<li>mobile - React-native/Expo project</li>
<li>common - common utility functions shared accross all package</li>
<li>constants - just a container for constant variables also shared accross all package</li>
</ul>
<p>By running <code>yarn dev</code> from the root folder, lerna.js will execute <code>yarn dev</code> in every and each package</p>
<p>Here are some of helpful lerna.js commands</p>
<pre><code>npx lerna add &#x3C;package>
</code></pre>
<p>this will add <package> as a dependency to all packages</package></p>
<pre><code>npx lerna add &#x3C;package1> --scope=&#x3C;package2>
</code></pre>
<p>this will add <package1> as a dependency to only package2</package1></p>
<pre><code>npx lerna publish
</code></pre>
<p>this will increase version of all packages and also will generate CHANGELOG.md files for all packages and also for a root repository, based on conventional commits. (see picture below)
<img src="https://thepracticaldev.s3.amazonaws.com/i/lwbsakys9rsbqbfp1mzq.png" alt="Alt Text"></p>
<pre><code>npx lerna bootstrap
</code></pre>
<p>Installs all of the package dependencies in all packages and links any cross-dependencies.</p>
<p>You can find more commands on Lerna.js's documentation</p>
<p>Here is a boilerplate link:</p>
<p><a href="https://github.com/shakogegia/mern-monorepo-boilerplate">Github Repository</a></p></article></article></main><footer class="bottom-0 mt-10 text-center w-full py-4 px-6 iAWriterQuattro"><small class="text-gray-500">Copyright Â© Shalva Gegia 2022. Made by<!-- --> <!-- --><a class="underline" href="/">Shalva Gegia</a> â€¢ <!-- --><a target="_blank" class="underline" rel="noopener" href="https://twitter.com/@ShalvaGegia">Twitter</a> â€¢ <!-- --><a target="_blank" class="underline" rel="noopener" href="https://github.com/shakogegia">Github</a></small></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"article":{"title":"MERN monorepo boilerplate","date":"2018-01-14T23:11:04.831Z","cover":null,"excerpt":"\u003cp\u003eHello reader,\nI want to talk about monorepo, and also will share boilerplate for MERN (Mongo, Express.js, React, React-Native/Expo) stack.\u003c/p\u003e\n\u003cp\u003eWhen it comes to a real-life project, it consists of multiple services fronted, backend/API and mobile. We can split them into separate repositories, but sharing code between repositories is difficult when using multiple repositories. This is the moment where monorepo shines.\u003c/p\u003e","content":"\u003cp\u003eHello reader,\nI want to talk about monorepo, and also will share boilerplate for MERN (Mongo, Express.js, React, React-Native/Expo) stack.\u003c/p\u003e\n\u003cp\u003eWhen it comes to a real-life project, it consists of multiple services fronted, backend/API and mobile. We can split them into separate repositories, but sharing code between repositories is difficult when using multiple repositories. This is the moment where monorepo shines.\u003c/p\u003e\n\u003c!-- read more --\u003e\n\u003cp\u003eLet's compare monorepo to mutli-repo style.\u003c/p\u003e\n\u003ch4\u003eMonorepo\u003c/h4\u003e\n\u003cp\u003eMonorepo is split into many single-repos. Each single-repo repository is read-only. You can change its code via pull-request to the monorepo.\u003c/p\u003e\n\u003ch4\u003eMultirepo\u003c/h4\u003e\n\u003cp\u003eThe other approach is to manage multiple repositories. 1 package = 1 own repository. Each package has its own development, tagging, and even maintainers.\u003c/p\u003e\n\u003ch4\u003eMonolith\u003c/h4\u003e\n\u003cp\u003eMonolith IS NOT monorepo. Monolith is a huge amount of coupled code of one application that is hell to maintain.\u003c/p\u003e\n\u003cp\u003eThis is what monorepo repository looks like\u003c/p\u003e\n\u003cp align=\"center\"\u003e\n  \u003cimg src=\"https://cdn-images-1.medium.com/max/1600/1*95IEDUCN3mfU9vpTWXChhQ@2x.png\" style=\"height:600px\"\u003e\n\u003c/p\u003e\n\u003ch2\u003eBoilerplate\u003c/h2\u003e\n\u003ch5\u003eLerna\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003eLerna is a tool that optimizes the workflow around managing multi-package repositories with git and npm.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eLerna tries to ease the management of npm links when dealing with multi-package projects hosted in a single repository. It analyzes the packages and automatically creates the required npm links between them. It also handles the execution of tasks across multiple packages and eases the pain of versioning and publishing.\nIt has its shortcomings but itâ€™s worth using it. Big projects like Babel and Jest use Lerna.\u003c/p\u003e\n\u003ch5\u003eYarn workspaces\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWorkspaces are a new way to setup your package architecture (..) It allows you to setup multiple packages in such a way that you only need to run yarn install once to install all of them in a single pass.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eYour dependencies can be linked together, which means that your workspaces can depend on one another while always using the most up-to-date code available. This is also a better mechanism than yarn link since it only affects your workspace tree rather than your whole system.\u003c/p\u003e\n\u003ch5\u003eEslint / Tslint / Stylelint / Prettier\u003c/h5\u003e\n\u003cp\u003eIn this boilerplate eslint, tslint, stylelint and prettier are already isntalled, configured and ready to go!\u003c/p\u003e\n\u003ch5\u003eHusky / Lint-staged / Commit lint\u003c/h5\u003e\n\u003cblockquote\u003e\n\u003cp\u003eHusky - Git hooks made easy\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eHusky is a tool which gives us the ability to catch GIT hooks like commit and/or push\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eLint-staged - Run linters against staged git files and don't let ðŸ’© slip into your code base!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eLint-staged is a nice tool to run linters (for example: eslint) on staged files to prevent commit code which is note linter compatible\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eConventional (Semantic) Commit Messages - is a lightweight convention on top of commit messages. It provides an easy set of rules for creating an explicit commit history;\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eConventional or Semantic commit messages is naming convension, that helps us to easily determine what commit contains and also it's very helpful to avoid multiple fixes in a single commit.\u003c/p\u003e\n\u003cp\u003eIf you are not familiar with conventional commits, here are some links with detailed info\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://www.conventionalcommits.org/en/v1.0.0-beta.4/\"\u003eConventional Commits\u003c/a\u003e\n\u003ca href=\"https://seesparkbox.com/foundry/semantic_commit_messages\"\u003eSemantic Commits\u003c/a\u003e\u003c/p\u003e\n\u003ch3\u003eHow to start\u003c/h3\u003e\n\u003cp\u003eAll you need is to clone \u003ca href=\"https://github.com/shakogegia/mern-monorepo-boilerplate\"\u003erepository\u003c/a\u003e, run \u003ccode\u003eyarn\u003c/code\u003e to install dependencies and you can start the project by running \u003ccode\u003eyarn dev\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://thepracticaldev.s3.amazonaws.com/i/7y04oyepefran5du6nv1.png\" alt=\"Alt Text\"\u003e\u003c/p\u003e\n\u003cp\u003ePackages structure:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eclient - React app created via\u003ccode\u003ecreate-react-app\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eapi - Node.js / Express.js\u003c/li\u003e\n\u003cli\u003esocket - Socket.io server\u003c/li\u003e\n\u003cli\u003emobile - React-native/Expo project\u003c/li\u003e\n\u003cli\u003ecommon - common utility functions shared accross all package\u003c/li\u003e\n\u003cli\u003econstants - just a container for constant variables also shared accross all package\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eBy running \u003ccode\u003eyarn dev\u003c/code\u003e from the root folder, lerna.js will execute \u003ccode\u003eyarn dev\u003c/code\u003e in every and each package\u003c/p\u003e\n\u003cp\u003eHere are some of helpful lerna.js commands\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003enpx lerna add \u0026#x3C;package\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ethis will add \u003cpackage\u003e as a dependency to all packages\u003c/package\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003enpx lerna add \u0026#x3C;package1\u003e --scope=\u0026#x3C;package2\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ethis will add \u003cpackage1\u003e as a dependency to only package2\u003c/package1\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003enpx lerna publish\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ethis will increase version of all packages and also will generate CHANGELOG.md files for all packages and also for a root repository, based on conventional commits. (see picture below)\n\u003cimg src=\"https://thepracticaldev.s3.amazonaws.com/i/lwbsakys9rsbqbfp1mzq.png\" alt=\"Alt Text\"\u003e\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003enpx lerna bootstrap\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eInstalls all of the package dependencies in all packages and links any cross-dependencies.\u003c/p\u003e\n\u003cp\u003eYou can find more commands on Lerna.js's documentation\u003c/p\u003e\n\u003cp\u003eHere is a boilerplate link:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://github.com/shakogegia/mern-monorepo-boilerplate\"\u003eGithub Repository\u003c/a\u003e\u003c/p\u003e"}},"__N_SSG":true},"page":"/article/[article]","query":{"article":"mern-monorepo-boilerplate"},"buildId":"lixbDq4aNc2m0zZOaRkxk","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>